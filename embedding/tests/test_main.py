import datetime
import json
import unittest
from pynumaflow.function import Datum, Messages
from app.main import map_handler


class test_main(unittest.TestCase):

    def test_embedding(self):
        ok_data = {}
        ok_data['id'] = 'test_data_id'
        ok_data['content'] = \
            """Singapore has 'a vested interest' in ensuring US-China communication lines are good: Ng Eng Hen - CNA Skip to main content Best News Website or Mobile Service WAN-IFRA Digital Media Awards Worldwide Best News Website or Mobile Service Digital Media Awards Worldwide Sign In Account My Feed Search Hamburger Menu Close Top Stories Singapore Asia World Commentary Sustainability Business Sport COVID-19 Latest News Discover CNA Insider Watch Live TV News Reports Documentaries & Shows TV Schedule Listen CNA938 Live Podcasts Radio Schedule Special Reports Singapore Parliament Mental Health Interactives World Cup Lifestyle Entertainment Women Wellness Living Style & Beauty Dining Travel Luxury Experiences Obsessions People Remarkable Living CNA Eyewitness Send us a news tip Events & Partnerships Branded Content Business Blueprint Health Matters The Asian Traveller Weather Edition: Singapore Asia Close Close Top Stories Singapore Asia World Commentary Sustainability Business Sport COVID-19 Latest News Discover CNA Insider Watch Live TV News Reports Documentaries & Shows TV Schedule Listen CNA938 Live Podcasts Radio Schedule Special Reports Singapore Parliament Mental Health Interactives World Cup Lifestyle Entertainment Women Wellness Living Style & Beauty Dining Travel Luxury Experiences Obsessions People Remarkable Living CNA Eyewitness Send us a news tip Events & Partnerships Branded Content Business Blueprint Health Matters The Asian Traveller Weather Edition: Singapore Asia Search Trending Topics China Malaysia CNA Explains ChatGPT Snap Insight Ukraine invasion Wellness Climate change COVID-19 Russia Follow CNA Follow our news Facebook Twitter Youtube LinkedIn RSS Recent Searches Trending Topics China Malaysia CNA Explains ChatGPT Snap Insight Ukraine invasion Wellness Climate change COVID-19 Russia Main navigation Top Stories Latest News Discover Singapore Asia Commentary Sustainability CNA Insider Lifestyle Watch Listen + All Sections Singapore Singapore has 'a vested interest' in ensuring US-China communication lines are good: Ng Eng Hen Bookmark Bookmark Share WhatsApp Telegram Facebook Twitter Email LinkedIn Close Close Top Stories Singapore Asia World Commentary Sustainability Business Sport COVID-19 Latest News Discover CNA Insider Watch Live TV News Reports Documentaries & Shows TV Schedule Listen CNA938 Live Podcasts Radio Schedule Special Reports Singapore Parliament Mental Health Interactives World Cup Lifestyle Entertainment Women Wellness Living Style & Beauty Dining Travel Luxury Experiences Obsessions People Remarkable Living CNA Eyewitness Send us a news tip Events & Partnerships Branded Content Business Blueprint Health Matters The Asian Traveller Weather Edition: Singapore Asia Search Trending Topics China Malaysia CNA Explains ChatGPT Snap Insight Ukraine invasion Wellness Climate change COVID-19 Russia Follow CNA Follow our news Facebook Twitter Youtube LinkedIn RSS Recent Searches Trending Topics China Malaysia CNA Explains ChatGPT Snap Insight Ukraine invasion Wellness Climate change COVID-19 Russia Advertisement Advertisement Singapore Singapore has 'a vested interest' in ensuring US-China communication lines are good: Ng Eng Hen Concerns have arisen about the deactivation of "guardrails" to keep both superpowers from conflict, said Singapore's Defence Minister Ng Eng Hen on the third and final day of the Shangri-La Dialogue. Singapore's Defence Minister Ng Eng Hen speaking to the media during a wrap-up interview at the Shangri-La Dialogue on Jun 4, 2023. (Photo: CNA/Louisa Tang) Louisa Tang Louisa Tang 04 Jun 2023 06:08PM (Updated: 04 Jun 2023 10:07PM) Bookmark Bookmark Share WhatsApp Telegram Facebook Twitter Email LinkedIn SINGAPORE: Singapore and other Association of Southeast Asian Nations (ASEAN) states are not “disinterested bystanders” in ongoing tensions between the United States and China, said Singapore’s Defence Minister Ng Eng Hen on Sunday (Jun 4). Speaking to reporters on the third and final day of the Shangri-La Dialogue, Dr Ng added that Singapore and ASEAN have "a vested interest” in making sure that communication lines between the two superpowers are good. The US and China do not want physical conflict but recognise they are a long way from an acceptable state of affairs, he noted. Reiterating comments he had made to the media on Saturday after a ministerial lunch, Dr Ng said that lines of communication are especially vital between potential adversaries. “I think it’s like Formula 1 drivers on the same circuit, driving blindfolded. You better be careful – and bystanders, too,” he cautioned. Dr Ng described US-China relations as being the “elephant in the room” at this year’s Shangri-La Dialogue – Asia’s top defence summit which is in its 20th edition this year. Related: China defence minister warns against 'NATO-like' alliances in Asia-Pacific Shangri-La Dialogue: Chinese general hits out at US Defense Secretary Lloyd Austin over Taiwan The relationship between the US and China is at its lowest point in years, as they remain deeply divided over issues like Taiwan to espionage and territorial disputes in the South China Sea. Earlier this week, China declined an invitation to meet the US at the summit due to the Americans’ refusal to lift sanctions imposed on Chinese Minister of National Defence Li Shangfu for purchasing Russian weapons. Both sides did not hold substantial meetings despite repeated demands by the US for military exchanges. General Li and US Secretary of State Lloyd Austin shook hands at an opening dinner on Friday, and sat across from each other at a ministerial roundtable and lunch hosted by Dr Ng on Saturday afternoon. Mr Austin had rebuked China in a speech at the summit on Saturday morning for refusing to hold military talks. On Sunday morning, General Li also gave a speech where he took thinly veiled digs at the US, accusing "some countries" of intensifying an arms race and wilfully interfering in the internal affairs of others. He also warned against establishing "NATO-like" military alliances in the Asia-Pacific, saying they would plunge the region into a "whirlpool" of conflict. US Defense Secretary Lloyd Austin III shakes hands with China Defense Minister Li Shangfu during the opening dinner for the 20th International Institute for Strategic Studies (IISS) Shangri-La Dialogue, Asia's annual defence and security forum, in Singapore, Jun 2, 2023. (Photo: AP/Vincent Thian) On Sunday, Dr Ng said that Singapore’s bilateral meetings were “very warm” but there were concerns about where the US-China relationship was headed, as well as the Ukraine conflict. “So there is no shortage of insight or will that some problems are just too big – even for many countries to come together, without the US and China coming together,” Dr Ng pointed out. “They’re the first and second largest economies. You can’t solve any problem without both of them coming into solution-making or finding a path forward.” He noted that Singapore’s neighbours – including Malaysia and Indonesia – have found ways to deconflict with Singapore. But all countries, as well as American and Chinese leaders, are concerned about the deactivation of “guardrails” to keep the US and China from conflict, he added. “And when you talk about the two largest economic and military powers, that's not a good position,” Dr Ng said. Also read: Simultaneous war in Europe and Asia will be ‘catastrophic’, says Ng Eng Hen Commentary: Deciphering China's mixed messages on US engagement after rejecting meeting between defence chiefs in Singapore GENERAL LI WAS "VERY CLEAR" IN SPEECH When asked about what he felt about General Li’s speech, Dr Ng said many leaders had told him they were impressed and said he was “very clear” in his stance. “I am glad that he delivered it in a calm manner. Whether you like the content or not depends on the listener, but the clarity was in terms of – if you like – where the red lines were; what effect it will have on countries. Each country will have to decide,” he added. In a plenary speech on Sunday morning, Dr Ng listed examples of how American and Chinese officials had conducted regular exchanges at all levels “as recent as a decade ago”. The US’ and China’s defence ministers last visited each other countries in 2018. Dr Ng told reporters: “People can forget that they were at that, and I think that’s something that you can aspire to. “I can assure you, if you put soldiers of two militaries together, they will click … it takes time. That’s the building of relationships. So we want (the US and China) to have that kind of relationship and we are confident that over time they will establish that.” “We're just observers, but we're not disinterested bystanders as I said. We have a vested interest to make sure that the US-China communication lines are good.” Dr Ng also gave some views on a Chinese warship that had on Saturday manoeuvred “in an unsafe manner” near an American warship transiting through the Taiwan Strait, according to the US military. Dr Ng said that all countries are “concerned when either big or fast-moving objects move close” to one another. “And that’s why, ASEAN, we’ve been working very hard to make sure that doesn’t happen,” he added, making reference to two sets of guidelines for unplanned air and sea encounters between ASEAN countries. “Incidents have happened ... and (that is) exactly our point. If it happens, who are you going to call? Ghostbusters?” Dr Ng quipped. In giving his assessment of how this year’s Shangri-La Dialogue had turned out, Dr Ng said that some people had told him that if there was no such thing at the moment, “we would have needed one very much”. “So in that sense, it’s an affirmation that the Shangri-La Dialogue plays a role and that it fills in the gaps now, obviously,” he added. Source: CNA/lt(zl) Related Topics shangri-la dialogue Ng Eng Hen US-China Advertisement Also worth reading Content is loading... Advertisement Expand to read the full story CNA Sections Asia Singapore Business CNA Insider Lifestyle Luxury CNA938 Live Commentary Interactives Live TV Sport World Special Reports About CNA About Us Advertise With Us Contact Us Hotel Partners Correspondents Presenters Mediacorp Network Pressed for time? Stay informed with CNA's newsletters Be among the first to know the Breaking news Choose a newsletter Morning Brief Evening Brief Breaking news alerts CNA Insider CNA Commentary All of the above This service is not intended for persons residing in the E.U. By clicking subscribe, I agree to receive news updates and promotional material from Mediacorp and Mediacorp's partners. Follow our news Facebook Twitter Youtube LinkedIn RSS Copyright© Mediacorp 2023. Mediacorp Pte Ltd. All rights reserved. Official Domain | Terms & Conditions | Privacy Policy This browser is no longer supported We know it's a hassle to switch browsers but we want your experience with CNA to be fast, secure and the best it can possibly be. To continue, upgrade to a supported browser or, for the finest experience, download the mobile app. Upgraded but still having issues? Contact us"""
        datum = Datum(keys=[],
                      event_time=datetime.datetime.now(),
                      watermark=datetime.datetime.now(),
                      metadata=None,
                      value=json.dumps(ok_data).encode("utf-8"))
        msgs = map_handler(None, datum)
        print(msgs)
        self.assertTrue(len(msgs.items()) > 0)
        data = json.loads(msgs.items()[0].value.decode("utf-8"))
        self.assertTrue('embedding' in data and len(data['embedding']) > 0)  # add assertion here


if __name__ == '__main__':
    import os
    import sys

    sys.path.append(os.getcwd())

    unittest.main()
